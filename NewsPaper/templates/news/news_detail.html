{% extends 'base.html' %}
{% block title %}
{{ news_detail.title }}
{% endblock title %}

{% block head %}
{% load static %}
<!-- Здесь может быть подключен JavaScript для управления модальным окном или выпадающим списком -->
{% endblock head %}

{% block content %}
<h1>{{ news_detail.title }}</h1>
<p>Дата публикации: {{ news_detail.created_at|date:"d.m.Y" }}</p>
<p>{{ news_detail.content }}</p>
<p>Автор: {{ news_detail.author.user.username }}</p>

<!-- Отображение категорий статьи -->
{% if user.is_authenticated %}
    {% for category in news_detail.categories.all %}
        <p>Категория: {{ category.name }}
        {% if category.id in subscribed_category_ids %}
            <form action="{% url 'unsubscribe' news_detail.id category.id %}" method="post">
                {% csrf_token %}
                <button type="submit">Отписаться</button>
            </form>
        {% else %}
            <form action="{% url 'subscribe' news_detail.id category.id %}" method="post">
                {% csrf_token %}
                <button type="submit">Подписаться</button>
            </form>
        {% endif %}
        </p>
    {% endfor %}

    <br>
    <!-- Кнопка для добавления новой категории -->
    <button id="addCategoryBtn">Добавить категорию</button>

    <!-- Модальное окно или выпадающий список для выбора категории -->
    <div id="categoryModal" style="display:none;">
        <form action="{% url 'add_category_to_article' news_detail.id %}" method="post">
            {% csrf_token %}
            <select name="category_id">
                {% for category in all_categories %}
                    <option value="{{ category.id }}">{{ category.name }}</option>
                {% endfor %}
            </select>
            <button type="submit">Добавить</button>
        </form>
    </div>
{% endif %}

<script>
    // JavaScript для управления отображением модального окна или выпадающего списка
    document.getElementById('addCategoryBtn').addEventListener('click', function() {
        document.getElementById('categoryModal').style.display = 'block';
    });
</script>

{% endblock content %}